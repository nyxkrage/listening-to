<div id="now-playing-container" style="width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: flex-end; padding: 20px; box-sizing: border-box; background: transparent; font-family: system-ui, -apple-system, sans-serif; position: relative; overflow: hidden;">
  <div id="album-art" style="position: absolute; top: 20px; left: 20px; width: 40px; height: 40px; border-radius: 8px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15); background: #f0f0f0;">
    <div style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; color: #999; font-size: 20px;">♪</div>
  </div>
  
  <div id="playing-indicator" style="position: absolute; top: 20px; right: 20px; display: none; align-items: center; gap: 4px;">
    <div style="width: 3px; height: 12px; background: #1db954; border-radius: 2px; animation: bounce 1s infinite;"></div>
    <div style="width: 3px; height: 16px; background: #1db954; border-radius: 2px; animation: bounce 1s infinite 0.1s;"></div>
    <div style="width: 3px; height: 10px; background: #1db954; border-radius: 2px; animation: bounce 1s infinite 0.2s;"></div>
  </div>
  
  <div style="margin-top: auto;">
    <div id="track-name" class="card-title" style="font-size: 16px; font-weight: 600; color: #111; margin: 0 0 4px 0; line-height: 1.3; word-break: break-word;">Loading...</div>
    <div id="artist-name" class="card-subtitle" style="font-size: 14px; color: #666; margin: 0; line-height: 1.3; word-break: break-word;">Last.fm</div>
  </div>
  
  <style>
    @keyframes bounce {
      0%, 100% { transform: scaleY(1); }
      50% { transform: scaleY(0.6); }
    }
  </style>
  
  <script>
    (async function() {
      try {
        const response = await fetch('https://ws.audioscrobbler.com/2.0/?method=user.getrecenttracks&user=nyxkrage&api_key=c1797de6bf0b7e401b623118120cd9e1&limit=1&format=json');
        const data = await response.json();
        
        if (data.recenttracks && data.recenttracks.track && data.recenttracks.track.length > 0) {
          const track = data.recenttracks.track[0];
          const isNowPlaying = track['@attr'] && track['@attr'].nowplaying === 'true';
          
          document.getElementById('track-name').textContent = track.name || 'Unknown Track';
          document.getElementById('artist-name').textContent = track.artist['#text'] || 'Unknown Artist';
          
          if (isNowPlaying) {
            document.getElementById('playing-indicator').style.display = 'flex';
            document.getElementById('artist-name').textContent = (track.artist['#text'] || 'Unknown Artist') + ' • Now Playing';
          } else if (track.date) {
            document.getElementById('artist-name').textContent = (track.artist['#text'] || 'Unknown Artist') + ' • ' + track.date['#text'];
          }
          
          // Try to get album art
          const images = track.image || [];
          const largeImage = images.find(img => img.size === 'large') || images.find(img => img.size === 'medium') || images[images.length - 1];
          
          if (largeImage && largeImage['#text']) {
            const artContainer = document.getElementById('album-art');
            artContainer.innerHTML = '<img src="' + largeImage['#text'] + '" style="width: 100%; height: 100%; object-fit: cover;" onerror="this.style.display=\'none\'; this.parentElement.innerHTML=\'<div style=\\\'width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; color: #999; font-size: 20px;\\\'>♪</div>\'">';
          }
        }
      } catch (error) {
        document.getElementById('track-name').textContent = 'Unable to load';
        document.getElementById('artist-name').textContent = 'Last.fm';
      }
    })();
  </script>
</div>
